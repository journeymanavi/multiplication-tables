
<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>Multiplication Tables Generator and Printer</title>
        <meta name="description" content="A simple webpage that helps you generate printer friendly multiplication tables.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,700,900" rel="stylesheet">
        <link rel="stylesheet" href="css/main.css">
    </head>
    <body>
    <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
    <![endif]-->

    <!-- Add your site or application content here -->
    <h1>Multiplication Tables</h1>
    <div id="control-panel">        
        <span id="float-label-group">
            <input id="numbers-input" class="" name="numbers" type="text" required maxlength=30/>
            <label id="numbers-label" for="numbers-input">Numbers (1,2,3-7)</label>
        </div>
    </div>
    <div id="tables">
        <div id="table-1" class="table red">
            <ol>
                <li><pre>1 x  1 =  1</pre></li>
                <li><pre>1 x  2 =  2</pre></li>
                <li><pre>1 x  3 =  3</pre></li>
                <li><pre>1 x  4 =  4</pre></li>
                <li><pre>1 x  5 =  5</pre></li>
                <li><pre>1 x  6 =  6</pre></li>
                <li><pre>1 x  7 =  7</pre></li>
                <li><pre>1 x  8 =  8</pre></li>
                <li><pre>1 x  9 =  9</pre></li>
                <li><pre>1 x 10 = 10</pre></li>
            </ol>
        </div>

        <div id="table-2" class="table green">
            <ol>
                <li><pre>2 x  1 =  2</pre></li>
                <li><pre>2 x  2 =  4</pre></li>
                <li><pre>2 x  3 =  6</pre></li>
                <li><pre>2 x  4 =  8</pre></li>
                <li><pre>2 x  5 = 10</pre></li>
                <li><pre>2 x  6 = 12</pre></li>
                <li><pre>2 x  7 = 14</pre></li>
                <li><pre>2 x  8 = 16</pre></li>
                <li><pre>2 x  9 = 18</pre></li>
                <li><pre>2 x 10 = 20</pre></li>
            </ol>
        </div>

        <div id="table-3" class="table blue">
            <ol>
                <li><pre>3 x  1 =  3</pre></li>
                <li><pre>3 x  2 =  6</pre></li>
                <li><pre>3 x  3 =  9</pre></li>
                <li><pre>3 x  4 = 12</pre></li>
                <li><pre>3 x  5 = 15</pre></li>
                <li><pre>3 x  6 = 18</pre></li>
                <li><pre>3 x  7 = 21</pre></li>
                <li><pre>3 x  8 = 24</pre></li>
                <li><pre>3 x  9 = 27</pre></li>
                <li><pre>3 x 10 = 30</pre></li>
            </ol>
        </div>

        <div id="table-4" class="table yellow">
            <ol>
                <li><pre>4 x  1 =  4</pre></li>
                <li><pre>4 x  2 =  8</pre></li>
                <li><pre>4 x  3 = 12</pre></li>
                <li><pre>4 x  4 = 16</pre></li>
                <li><pre>4 x  5 = 20</pre></li>
                <li><pre>4 x  6 = 24</pre></li>
                <li><pre>4 x  7 = 28</pre></li>
                <li><pre>4 x  8 = 32</pre></li>
                <li><pre>4 x  9 = 36</pre></li>
                <li><pre>4 x 10 = 40</pre></li>
            </ol>
        </div>

        <div id="table-5" class="table red">
            <ol>
                <li><pre>5 x  1 =  5</pre></li>
                <li><pre>5 x  2 = 10</pre></li>
                <li><pre>5 x  3 = 15</pre></li>
                <li><pre>5 x  4 = 20</pre></li>
                <li><pre>5 x  5 = 25</pre></li>
                <li><pre>5 x  6 = 30</pre></li>
                <li><pre>5 x  7 = 35</pre></li>
                <li><pre>5 x  8 = 40</pre></li>
                <li><pre>5 x  9 = 45</pre></li>
                <li><pre>5 x 10 = 50</pre></li>
            </ol>
        </div>

        <div id="table-6" class="table green">
            <ol>
                <li><pre>6 x  1 =  6</pre></li>
                <li><pre>6 x  2 = 12</pre></li>
                <li><pre>6 x  3 = 18</pre></li>
                <li><pre>6 x  4 = 24</pre></li>
                <li><pre>6 x  5 = 30</pre></li>
                <li><pre>6 x  6 = 36</pre></li>
                <li><pre>6 x  7 = 42</pre></li>
                <li><pre>6 x  8 = 48</pre></li>
                <li><pre>6 x  9 = 54</pre></li>
                <li><pre>6 x 10 = 60</pre></li>
            </ol>
        </div>

        <div id="table-7" class="table blue">
            <ol>
                <li><pre>7 x  1 =  7</pre></li>
                <li><pre>7 x  2 = 14</pre></li>
                <li><pre>7 x  3 = 21</pre></li>
                <li><pre>7 x  4 = 28</pre></li>
                <li><pre>7 x  5 = 35</pre></li>
                <li><pre>7 x  6 = 42</pre></li>
                <li><pre>7 x  7 = 49</pre></li>
                <li><pre>7 x  8 = 56</pre></li>
                <li><pre>7 x  9 = 63</pre></li>
                <li><pre>7 x 10 = 70</pre></li>
            </ol>
        </div>

        <div id="table-8" class="table yellow">
            <ol>
                <li><pre>8 x  1 =  8</pre></li>
                <li><pre>8 x  2 = 16</pre></li>
                <li><pre>8 x  3 = 24</pre></li>
                <li><pre>8 x  4 = 32</pre></li>
                <li><pre>8 x  5 = 40</pre></li>
                <li><pre>8 x  6 = 48</pre></li>
                <li><pre>8 x  7 = 56</pre></li>
                <li><pre>8 x  8 = 64</pre></li>
                <li><pre>8 x  9 = 72</pre></li>
                <li><pre>8 x 10 = 80</pre></li>
            </ol>
        </div>

        <div id="table-9" class="table red">
            <ol>
                <li><pre>9 x  1 =  9</pre></li>
                <li><pre>9 x  2 = 18</pre></li>
                <li><pre>9 x  3 = 27</pre></li>
                <li><pre>9 x  4 = 36</pre></li>
                <li><pre>9 x  5 = 45</pre></li>
                <li><pre>9 x  6 = 54</pre></li>
                <li><pre>9 x  7 = 63</pre></li>
                <li><pre>9 x  8 = 72</pre></li>
                <li><pre>9 x  9 = 81</pre></li>
                <li><pre>9 x 10 = 90</pre></li>
            </ol>
        </div>

        <div id="table-10" class="table green">
            <ol>
                <li><pre>10 x  1 = 10</pre></li>
                <li><pre>10 x  2 = 20</pre></li>
                <li><pre>10 x  3 = 30</pre></li>
                <li><pre>10 x  4 = 40</pre></li>
                <li><pre>10 x  5 = 50</pre></li>
                <li><pre>10 x  6 = 60</pre></li>
                <li><pre>10 x  7 = 70</pre></li>
                <li><pre>10 x  8 = 80</pre></li>
                <li><pre>10 x  9 = 90</pre></li>
                <li><pre>10 x 10 = 100</pre></li>
            </ol>
        </div>

    </div>    

    <script type="text/javascript">
        // Returns a function, that, as long as it continues to be invoked, will not
        // be triggered. The function will be called after it stops being called for
        // N milliseconds. If `immediate` is passed, trigger the function on the
        // leading edge, instead of the trailing.
        function debounce(func, wait, immediate) {
            var timeout;
            return function() {
                var context = this, args = arguments;
                var later = function() {
                    timeout = null;
                    if (!immediate) func.apply(context, args);
                };
                var callNow = immediate && !timeout;
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
                if (callNow) func.apply(context, args);
            };
        };

        window.onload = function() {
            //generate tables markup
            // var colors = ['red','green','blue','yellow'];
            // for(i=1;i<11;i++) { 
            //   console.log(`<div id="table-${i}" class="table ${colors[(i-1)%4]}">`);
            //   console.log("  <ol>");
            //   for(j=1;j<11;j++) { 
            //     console.log(`    <li><pre>${i} x ${j < 10 ? ' '+j : j} = ${(i*j) < 10 ? ' '+(i*j) : (i*j)}</pre></li>`); 
            //   }
            //   console.log("  </ol>");
            //   console.log("</div>")
            // }

            document.querySelector("#numbers-input")
            .addEventListener('input', debounce(
                function(e) {
                    if(e.keyIdentifier !== 'U+00BC') {
                        renderTables(parseInput(e.target.value));
                    }
                },
                150));
        };

        function parseInput(inputText) {
            var tokens = inputText.split(/,/);
            var tokenCount = tokens.length;
            var result = [];
            var seen = {};

            for (var i = 0; i < tokenCount; i++) {
                var token = tokens[i].trim();
                var rangeToken = token.match(/^([1-9]|10)-([1-9]|10)$/);
                if (rangeToken) {
                    var start = +rangeToken[1];
                    var end = +rangeToken[2];
                    if (start < end) {
                        for (var j=start; j<=end; j++) {
                            if(seen[j] !== 1)  {
                                seen[j] = 1;
                                result.push(+j);
                            }
                        }
                    }
                } else if(token.match(/^(?:[1-9]|10)$/)) {
                    if(seen[token] !== 1) {
                        seen[token] = 1;
                        result.push(+token);
                    }
                }
            }

            return result.sort(function(a,b) { return a - b; });
        }

        function addClass(el, className) {
            var classes = el.attributes.class.value.split(/ /);
            if (classes.indexOf(className) === -1) {
                el.attributes.class.value = classes.concat(className).join(" ");
            }
        }

        function removeClass(el, className) {
            var classes = el.attributes.class.value.split(/ /);
            var indexOfClass = classes.indexOf(className);
            if (indexOfClass >= 0) {
                //splice manipulates the array in place and returns the spliced element,
                //so need to be cautious while chaining .splice()
                classes.splice(indexOfClass, 1);
                el.attributes.class.value = classes.join(" ");
            }
        }

        function renderTables(tablesFor) {
            for(var i=1; i<=10; i++) {
                var table = document.querySelector("#table-"+i);
                if(tablesFor.indexOf(i) >= 0) {
                    addClass(table, 'displayed');
                    setTimeout(function() {
                     addClass(this, 'visible');
                    }.bind(table), 50);
                } else {
                    removeClass(table, 'visible');
                    window.setTimeout((function() {
                        removeClass(this, 'displayed');
                    }).bind(table), 300);
                }
            }
        }
    </script>
    </body>
</html>
